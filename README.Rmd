---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# kh package

<!-- badges: start -->
<!-- badges: end -->

The goal of kh is to ...

## Installation

You can install the development version of `kh` from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("horankev/kh")
```

```{r}
# required packages
packages <- c(
  "rnaturalearth",
  "sf"
  )

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE, quietly = TRUE))
```

## Example

Often when preparing areal spatial data, the presence of uncontiguous areas (usually islands) can create difficulties. These functions help to make the process of generating spatial structures less complicated.

```{r example}
library(kh)
## basic example code
```

The following is a map of the UK from the `rnaturalearth` package. It features many non-contiguous units. In the following example of `make_cont_k_islands`, the argument k is set to one. This means that in addition to all of the normal contiguities, all islands will be joined to the one unit which is closest to them. This can be piped into the `makemap` function so that the contiguities can be visually inspected.

```{r, fig.width=8, fig.height=8, warning=FALSE}

uk <- ne_states(country="united kingdom", returnclass = "sf") |> 
  st_cast("POLYGON")
uk$id <- 1:nrow(uk)

uk_cont <- make_cont_k_islands(data = uk,
                    unit = id,
                    link_islands_k = 1) |> 
  makemap(uk, id)

```

This could be changed to join each island to the two closest units as in this example with the countries of Asia.

```{r, fig.width=12, fig.height=8}

asia <- ne_countries(continent="asia", returnclass = "sf")
asia_cont <- make_cont_k_islands(data = asia,
                    unit = admin,
                    link_islands_k = 2) |> 
  makemap(asia, admin)

```

And for a country such as Indonesia which has many islands.

```{r, fig.width=12, fig.height=8, warning=FALSE}

indonesia <- ne_states(country="indonesia", returnclass = "sf") |> 
  st_cast("POLYGON")
indonesia$id <-1:nrow(indonesia)
indonesia_cont <- make_cont_k_islands(data = indonesia,
                    unit = id,
                    link_islands_k = 2) |> 
  makemap(indonesia, id)

```

Rather than operating at the individual island level, this can be done at a higher level by changing an argument in the function.

```{r, fig.width=12, fig.height=8, warning=FALSE}

indonesia <- ne_states(country="indonesia", returnclass = "sf") |> 
  st_cast("POLYGON")
indonesia$id <-1:nrow(indonesia)
indonesia_cont <- make_cont_k_islands(data = indonesia,
                    unit = name,
                    link_islands_k = 2) |> 
  makemap(indonesia, name)

```
